# Email Receiver
一个用于自动收取作业的bot

因为不想手动收作业，所以花费比手动收作业多n倍的时间开发了一个自动收发作业bot。

## 功能

- 匹配格式正确的邮件主题，并自动分类、存取作业。
- 支持后台定时运行or一键识别前n封邮件。
- 支持作业匹配成功后自动回复。
- 支持Server酱通知。
- 支持多门课程作业同时接收。
- 支持文件格式匹配。
- 支持文件更新。
- 温馨的问候语。

<img src="https://tva1.sinaimg.cn/large/0081Kckwly1gk33t6n7xwj30fd0dgt9r.jpg" width="40%">

## 环境及配置指南
- 安装python3及jieba库。
`pip3 install --index-url https://pypi.tuna.tsinghua.edu.cn/simple/ jieba`
- 复制config.sample.ini并改名为config.ini
- 配置config.ini
- 在根目录下运行命令即可：
`python3 main.py`

### 对于服务器玩家
建议将项目直接配置在服务器端，通过screen等方式实现后台运行。

## 运行逻辑

### 模式设定
- 在listener模式下，程序会定时查看邮件，当出现邮件标题可以被解析为作业提交的格式时，查看正文内容并下载所有附件。
- 在viewer模式下，程序会一次性查看前n封邮件（取决于viewer_num参数)，其它内容同上，查看完成后自动退出。

### 自动回复
开启自动回复后，程序会自动回复解析成功的邮件。
回复内容分为4类：
1. 作业已收到
2. 作业已更新
3. 作业格式有误
4. 邮件标题格式有误
   
其中选项4的原理是，当解析出学号、作业、科目、注释信息后，剩余信息长度大于4（一般姓名长度<=4）时，会被认为是邮件标题格式有误并回复。

## 匹配作业格式

作业格式**仅参考邮件主题**，请告知所有同学邮件主题格式为：

> **学号姓名科目作业x(注释)**

如：1800011111小田计算机图形学作业1(使用平台：VS2019)

目前文件命名会被忽略并自动格式化，所有邮件正文也会被忽略。
> 事实上我试图匹配同学们的所有主题，例如交换学号和姓名的位置，把“作业x”写成“第x次作业”、“作业一”、“作业-”。但效果欠佳，需要大量同学上交作业来检查我的parser是否有鲁棒性。